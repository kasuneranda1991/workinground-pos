$(document).ready(function(){$(".dblckick").dblclick(function(e){e.preventDefault(),console.log("Disabled Double Click"),$(this).attr("disabled","disabled")});var e="";function t(e){$("#billingModal").modal("show"),$("#billingSubmitBtn").removeAttr("disabled"),$("#itemName").text(e.display_name),$("#count_type").text(e.count_type),$("#selling_price").val(e.selling_price),$("#bill_item_id").val(e.product_id),$("#bill_item_type_id").val(e.type_id),$("#selling_qty").val(""),$("#selling_batch_no").val(""),$("#selling_discount").val(""),$("#serial_no").val("")}function a(){$.ajax({type:"get",url:"/unsettledBillCount",success:function(e){$("#unsettle-bill").empty(),$("#unsettle-bill").append("<em class='animated filpInX'>"+e+"</em>")}})}function n(){$.ajax({type:"get",url:"/cartTotal",success:function(e){$("#cart-total").empty(),$("#cart-total").append("<h4>Total Payble Amount : Rs."+e.total+"</h4>")}})}function l(e){$("#products").empty(),$.ajax({type:"get",url:"/testyear",success:function(a){$.each(a.products,function(a,n){e==n.type_id?($("#products").append("<div style='cursor: pointer;' id='"+n.product_id+"' class='col-lg-4 col-md-4 col-sm-6 col-xs-12 animated fadeInDown'><div class='card'><div class='header'><h2>"+n.display_name+"</h2><ul class='header-dropdown m-r--5'><span>Rs."+n.selling_price+"</span></ul></div><div class='body'><span class='label label-success'>"+n.qty+" "+n.count_type+"</span><span class='float-right label label-info'>"+n.alert+"</span></div></div></div>"),$("#"+n.product_id).click(function(){t(n)})):0==e&&($("#products").append("<div style='cursor: pointer;' id='"+n.product_id+"' class='col-lg-4 col-md-4 col-sm-6 col-xs-12 animated fadeInDown'><div class='card'><div class='header'><h2>"+n.display_name+"</h2><ul class='header-dropdown m-r--5'><span>Rs."+n.selling_price+"</span></ul></div><div class='body'><span class='label label-success'>"+n.qty+" "+n.count_type+"</span><span class='float-right label label-info'>"+n.alert+"</span></div></div></div>"),$("#"+n.product_id).click(function(){t(n)}))})}})}$("#settleBillBtn").click(function(){$("#finishBillBtn").removeAttr("Disabled"),$.ajax({type:"get",url:"/cartTotal",success:function(e){$("#Bill_Total_Amount").empty(),$("#Bill_Total_Amount").append("<h4>Total Payble Amount : Rs."+e.total+"</h4>"),$("#sette_bill_id").val(e.bill_no)}})}),$("#PrintreceiptBtn").click(function(){webprint.printRaw(getEscSample($("#cutter").is(":checked"),$("#image").is(":checked")),$("#printerlist").val())}),$("#finishBillBtn").on("click",function(t){var n=$("#finishBillForm"),l=n.attr("action");$("#finishBillBtn").attr("Disabled","Disabled"),$.ajax({type:"POST",url:l,data:n.serialize(),success:function(t){if(a(),$("#billingModal").modal("hide"),1==t.success)$(".modal").modal("hide"),$("#printBillReceiptModal").modal("show"),$("#total").val(t.total),$("#dis").val(t.dis),$("#cash").val(t.cash),$("#balance").val(t.balance),$("#bill_no").val(t.bill_no),$("#cash_amount").val(null),$("#customer_no").val(null),e=t.items,$.notify({wrapper:"body",message:t.data,type:"success",position:8,dir:"ltr",autoClose:!0,duration:3e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/definite_flo9zz.ogg").play();else if(1==t.error){$("#finishBillBtn").removeAttr("Disabled"),$.notify({wrapper:"body",message:t.data,type:"error",position:8,dir:"ltr",autoClose:!0,duration:15e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/error_jydv0i.ogg").play()}}}),t.preventDefault()}),$.ajax({type:"get",url:"/testyear",success:function(e){$.each(e.type,function(e,t){$("#category").append("<li><a href='#' class='waves-effect waves-block' id='type"+t.id+"' data-type='"+t.id+"'><span>"+t.type+"</span></a></li>")})}}),$("#all_product").click(function(e){e.preventDefault(),$("#products").empty(),l(0)}),$.ajax({type:"get",url:"/testyear",success:function(e){$.each(e.type,function(e,t){$("#type"+t.id).attr("disabled","disabled"),$("#type"+t.id).click(function(e){e.preventDefault(),$("#catogery_name").text(t.type),$(this).attr("disabled","disabled"),l($(this).attr("data-type"))})})}}),window.onload=l(0),window.onload=a(),$("#shopping_cart_trigger").click(function(){$("#shoppingCart").DataTable().ajax.reload(null,!1),$("#cartModal").modal("show"),n()}),$.ajax({type:"get",url:"/testjson",success:function(e){$(".search-bar").search({source:e,onSelect:function(e,t){console.log(e,"result"),console.log(t,"response"),$("#billingSubmitBtn").removeAttr("disabled"),$("#billingModal").modal("show"),$("#itemName").text(e.title),$("#count_type").text(e.count_type),$("#selling_price").val(e.selling_price),$("#bill_item_id").val(e.id),$("#bill_item_type_id").val(e.type_id),$("#selling_qty").val(""),$("#selling_batch_no").val(""),$("#selling_discount").val(""),$("#serial_no").val("")}})}}),$("#billingSubmitBtn").on("click",function(e){var n=$("#billing_item_form_validation"),l=n.attr("action");$(this).attr("disabled","disabled"),$.ajax({type:"POST",url:l,data:n.serialize(),success:function(e){if(a(),$("#billingModal").modal("hide"),1==e.success)$("#products").empty(),$.ajax({type:"get",url:"/testyear",success:function(a){$.each(a.products,function(a,n){e.type_id==n.type_id&&($("#products").append("<div style='cursor: pointer;' id='"+n.product_id+"' class='col-lg-4 col-md-4 col-sm-6 col-xs-12 animated pulse'><div class='card'><div class='header'><h2>"+n.display_name+"</h2><ul class='header-dropdown m-r--5'><span>Rs."+n.selling_price+"</span></ul></div><div class='body'><span class='label label-success'>"+n.qty+" "+n.count_type+"</span><span class='float-right label label-info'>"+n.alert+"</span></div></div></div>"),$("#"+n.product_id).click(function(){t(n)}))})}}),$.notify({wrapper:"body",message:e.data,type:"success",position:8,dir:"ltr",autoClose:!0,duration:3e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/definite_flo9zz.ogg").play();else if(1==e.error){$.notify({wrapper:"body",message:e.data,type:"error",position:8,dir:"ltr",autoClose:!0,duration:15e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/error_jydv0i.ogg").play()}}}),e.preventDefault()});var _=$("#shoppingCart").DataTable({processing:!0,serverSide:!0,deferRender:!0,responsive:!0,ajax:"/ShoppingCartBillDataShouldBeEncriptedToRemoveUnauthorizedAccess3",columns:[{data:"batch_no",name:"batch_no"},{data:"product_name",name:"product_name"},{data:"qty",name:"qty"},{data:"discount",name:"discount"},{data:"serial_no",name:"serial_no"},{data:"total_price",name:"total_price"},{data:"action",name:"action"}]});if($("#shoppingCart tbody").on("click","button",function(e){var t=_.row($(this).parents("tr")).data();$("#remove_item_id").val(t.id);t.product_id,t.qty;var l=$("#shoppingCartItemRemoveForm"),i=l.attr("action");$.ajax({type:"POST",url:i,data:l.serialize(),success:function(e){a(),n(),console.log("item Removed")}}),e.preventDefault(),_.ajax.reload(null,!1)}),"pos"==$("#printer_type").val()){webprint=new WebPrint(!0,{relayHost:"127.0.0.1",relayPort:"8080",listPrinterCallback:function(e){var t=$("#printerlist");for(var a in t.html(""),e)t.append('<option value="'+e[a]+'">'+e[a]+"</option>")},listPortsCallback:function(e){var t=$("#portlist");for(var a in t.html(""),e)t.append('<option value="'+e[a]+'">'+e[a]+"</option>");$("#portlist option").length&&webprint.openPort($("#portlist option:first-child").val(),{baud:"9600",databits:"8",stopbits:"1",parity:"1",flow:"none"})},readyCallback:function(){webprint.requestPorts(),webprint.requestPrinters()}});getEscSample=function(t,a){var n=document.getElementById("shop_name").value,l=document.getElementById("address").value,_=document.getElementById("city").value,g=document.getElementById("contact_no").value,f=document.getElementById("time").value,h=document.getElementById("cashier").value,w=document.getElementById("total").value,B=document.getElementById("balance").value,k=document.getElementById("cash").value,x=document.getElementById("bill_no").value,I=document.getElementById("dis").value,D="";return a&&(D+=o+i+r+c+n+"\n"+m),D+=r+g+"\n",D+=r+l+"\n",D+=r+_+"\n",D+=s+u+"Teller:"+h+"\n",D+=s+"Time  :"+f+"\n",D+=s+"Bill No:#"+x+"\n",D+=r+"________________________________________________________\n",D+=s+"Item                               Qty     Price\n",D+=r+"________________________________________________________\n",e&&$.each(e,function(e,t){var a="";$.each(t,function(e,t){a+=t}),D+=s+a}),D+=r+"________________________________________________________\n"+c,D+=s+"Total    Rs.",D+=d+w+"\n",D+=r+u+"________________________________________________________\n",D+=s+m+"Discount :Rs."+I+"\n",D+=s+"Cash     :Rs."+k+"\n",D+=s+"Balance  :Rs."+B+"\n"+u+v,D+=r+"________________________________________________________\n",D+=r+m+"Thank You.Come Again\n",D+=r+"\n",D+=r+u+"Exchange Possible in 7 Days\n",D+=r+"Item should be with its original state \n",D+=r+"We do not Refund money \n",D+=r+"\n",D+=r+"________________________________________________________\n",D+=r+p+"CopyrightÂ©workinground.com\n",D+=r+"All Rights Reserved\n",D+=r+"072-0782825",D+=y,D+=y,D+=y,D+=y,D+=y,D+=b};var i="@",o="p0",s="a0",r="a1",d="a2",c="!1",u="!",p="}&Ã¤",m="!",y="\n",v="E0",b="i"}var g=$("#settledBillTable").DataTable({processing:!0,serverSide:!0,deferRender:!0,responsive:!0,ajax:"/SettledBillDataShouldBeEncriptedToRemoveUnauthorizedAccess3",columns:[{data:"transaction_id",name:"transaction_id"},{data:"product_name",name:"product_name"},{data:"qty",name:"qty"},{data:"discount",name:"discount"},{data:"total_price",name:"total_price"},{data:"created_at",name:"created_at"},{data:"action",name:"action"}]});$("#settledBillTable tbody").on("click","button.returnItemForm",function(){var e=g.row($(this).parents("tr")).data();$("#returnItemFormModal").modal("show"),$("#returnItemModal").modal("hide"),$("#returnBtn").removeAttr("disabled"),$("#return_item_name").text(e.product_name),$("#return_discount").val(e.discount),$("#return_quantity").val(e.qty),$("#return_raw_id").val(e.id)}),$("#returnBtn").on("click",function(e){$(this).attr("disabled","disabled"),$("#returnItemModal").modal("show");var t=$("#returnItemFormnew"),a=t.attr("action");$.ajax({type:"POST",url:a,data:t.serialize(),success:function(e){if(1==e.success)$("#returnItemFormModal").modal("hide"),$.notify({wrapper:"body",message:e.data,type:"success",position:8,dir:"ltr",autoClose:!0,duration:3e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/definite_flo9zz.ogg").play();else if(1==e.error){$.notify({wrapper:"body",message:e.data,type:"error",position:8,dir:"ltr",autoClose:!0,duration:15e3}),new Audio("https://res.cloudinary.com/workinground/video/upload/v1556016673/sound/error_jydv0i.ogg").play()}}}),e.preventDefault(),g.ajax.reload(null,!1)})});